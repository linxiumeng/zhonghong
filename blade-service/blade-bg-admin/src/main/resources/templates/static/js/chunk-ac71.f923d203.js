(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ac71"],{CfIx:function(e,t,s){"use strict";var i=s("zDDj");s.n(i).a},Z3o0:function(e,t,s){"use strict";s.r(t);var i=s("m1cH"),r=s.n(i),n=s("gDS+"),a=s.n(n),o=s("fBUP"),l={data:function(){return{rowData:{},defaultChecked:[],permissionTree:[],permissionObj:{},defaultProps:{children:"children",label:"label"}}},created:function(){var e=this.$route.params.row;if(e)this.rowData=this.$route.params.row,localStorage.permissionData=a()(e);else{if(!localStorage.permissionData)return void this.$message({message:"无法找到参数，请关闭该标签重试",type:"error"});this.rowData=JSON.parse(localStorage.permissionData)}this.getMenuList()},destroyed:function(){this.$store.dispatch("delView",{path:"/systemManage/editRolesPermission",name:"editRolesPermission"}),localStorage.permissionData=null},methods:{getMenuList:function(){var e=this;this.$http.post(o.a.systemManage.getMenuList,{roleId:this.rowData.roleId}).then(function(t){e.permissionTree=e.switchTree(t.result);var s=t.roleMenuIdList.filter(function(t){if(!e.permissionObj[t]||!e.permissionObj[t].hasChildren)return t});t.roleMenuIdList.includes(0)?e.defaultChecked=s:e.defaultChecked=[0].concat(r()(s))})},submit:function(){var e=this;this.$http.post(o.a.systemManage.editRoles,{roleId:this.rowData.roleId,roleName:this.rowData.roleName,menuIdList:[].concat(r()(this.$refs.premissionTree.getHalfCheckedKeys()),r()(this.$refs.premissionTree.getCheckedKeys()))}).then(function(t){e.$message({message:"操作成功",type:"success"})})},returnToPrev:function(){this.$router.push("/systemManage/rolesManage")},switchTree:function(e){var t=this,s=[],i={};return e.forEach(function(e,t){-1===e.parentId&&(s.push({id:e.menuId,label:e.name,disabled:!e.menuId}),i["s1"+e.menuId]=s.length-1)}),e.forEach(function(e,r){var n=i["s1"+e.parentId];n&&(t.permissionObj[e.parentId]={hasChildren:!0},s[n].children||(s[n].children=[]),s[n].children.push({id:e.menuId,label:e.name}),i["s2"+e.menuId]=n+"-"+(s[n].children.length-1))}),e.forEach(function(e,r){var n=i["s2"+e.parentId];if(n){t.permissionObj[e.parentId]={hasChildren:!0};var a=n.split("-")[0],o=n.split("-")[1];s[a].children[o].children||(s[a].children[o].children=[]),s[a].children[o].children.push({id:e.menuId,label:e.name})}}),s}}},c=(s("CfIx"),s("KHd+")),d=Object(c.a)(l,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"edit-roles-permission-container"},[s("div",{staticClass:"top-info"},[s("h3",{staticClass:"roles-name"},[e._v("角色名称: "+e._s(e.rowData.roleName))]),e._v(" "),s("el-button",{staticClass:"fr",attrs:{type:"primary",size:"mini"},on:{click:e.returnToPrev}},[e._v("返回")])],1),e._v(" "),s("div",{staticClass:"permission-tree"},[s("p",{staticClass:"tree-tips"},[e._v("请勾选权限")]),e._v(" "),s("el-tree",{ref:"premissionTree",attrs:{data:e.permissionTree,"default-checked-keys":e.defaultChecked,props:e.defaultProps,"empty-text":"数据加载中","show-checkbox":"","node-key":"id"}})],1),e._v(" "),s("el-button",{staticClass:"permission-btn",attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("提交")])],1)},[],!1,null,"c1c7648a",null);d.options.__file="editRolesPermission.vue";t.default=d.exports},"gDS+":function(e,t,s){e.exports={default:s("oh+g"),__esModule:!0}},"oh+g":function(e,t,s){var i=s("WEpk"),r=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},zDDj:function(e,t,s){}}]);